{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { FlatList, TextInput } from 'react-native-gesture-handler';\nimport Icon from \"@expo/vector-icons/FontAwesome5\";\nimport { UIHeader } from \"../../components\";\nimport { colors } from \"../../constants\";\nimport MessengerItem from \"./MessengerItem\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { firebaseDatabase, firebaseDatabaseRef, firebaseSet } from \"../../firebase/firebase\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar Messenger = function Messenger(props) {\n  var _props$route$params$u = props.route.params.user,\n      url = _props$route$params$u.url,\n      name = _props$route$params$u.name;\n  var navigation = props.navigation;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      typedText = _useState2[0],\n      setTypedText = _useState2[1];\n\n  var _useState3 = useState([{\n    url: 'https://randomuser.me/api/portraits/men/70.jpg',\n    showUrl: true,\n    isSender: true,\n    messenger: \"Hello\",\n    timestamp: 1641654238000\n  }, {\n    url: 'https://randomuser.me/api/portraits/men/70.jpg',\n    showUrl: false,\n    isSender: true,\n    messenger: \"How are you ?\",\n    timestamp: 1641654298000\n  }, {\n    url: 'https://randomuser.me/api/portraits/men/70.jpg',\n    showUrl: false,\n    isSender: true,\n    messenger: \"How about your work ? How about your work ? How about your work ? How about your work ? How about your work ? How about your work ?\",\n    timestamp: 1641654538000\n  }, {\n    url: 'https://randomuser.me/api/portraits/men/50.jpg',\n    showUrl: true,\n    isSender: false,\n    messenger: \"Yes\",\n    timestamp: 1641654598000\n  }, {\n    url: 'https://randomuser.me/api/portraits/men/50.jpg',\n    showUrl: false,\n    isSender: false,\n    messenger: \"I am fine\",\n    timestamp: 1641654598000\n  }, {\n    url: 'https://randomuser.me/api/portraits/men/70.jpg',\n    showUrl: true,\n    isSender: true,\n    messenger: \"Let's go out\",\n    timestamp: 1641654778000\n  }]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      chatHistory = _useState4[0],\n      setChatHistory = _useState4[1];\n\n  return _jsxs(View, {\n    style: {\n      flexDirection: 'column',\n      flex: 1\n    },\n    children: [_jsx(UIHeader, {\n      title: name,\n      lefIconName: 'arrow-left',\n      rightIconName: 'ellipsis-v',\n      onPressLeftIcon: function onPressLeftIcon() {\n        navigation.goBack();\n      },\n      onPressRightIcon: function onPressRightIcon() {\n        return alert('right icon');\n      }\n    }), _jsx(FlatList, {\n      style: {\n        flex: 1\n      },\n      keyExtractor: function keyExtractor(item) {\n        return item.messenger;\n      },\n      data: chatHistory,\n      renderItem: function renderItem(_ref) {\n        var item = _ref.item,\n            index = _ref.index;\n        return _jsx(MessengerItem, {\n          item: item,\n          onPress: function onPress() {\n            return alert(\"234\");\n          }\n        }, \"\" + item.timestamp);\n      }\n    }), _jsxs(View, {\n      style: {\n        height: 50,\n        position: 'absolute',\n        bottom: 0,\n        left: 0,\n        right: 0,\n        borderWidth: 1,\n        borderTopColor: '#ccc',\n        flexDirection: 'row',\n        justifyContent: 'space-between',\n        alignItems: 'center'\n      },\n      children: [_jsx(TextInput, {\n        value: typedText,\n        onChangeText: function onChangeText(text) {\n          setTypedText(text);\n        },\n        placeholder: \"Enter your message here\",\n        placeholderTextColor: colors.placeholder,\n        style: {\n          height: 50,\n          paddingStart: 10,\n          color: 'black',\n          flex: 1\n        }\n      }), _jsx(TouchableOpacity, {\n        onPress: function _callee() {\n          var newMessageObject, stringUser, myUserId, myFriendId;\n          return _regeneratorRuntime.async(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  if (!(typedText.trim().length == 0)) {\n                    _context.next = 2;\n                    break;\n                  }\n\n                  return _context.abrupt(\"return\");\n\n                case 2:\n                  newMessageObject = {\n                    url: 'https://randomuser.me/api/portraits/men/70.jpg',\n                    showUrl: true,\n                    isSender: true,\n                    messenger: typedText,\n                    timestamp: new Date().getTime()\n                  };\n                  debugger;\n                  _context.next = 6;\n                  return _regeneratorRuntime.awrap(AsyncStorage.getItem('user'));\n\n                case 6:\n                  stringUser = _context.sent;\n                  myUserId = JSON.parse(stringUser).userId;\n                  myFriendId = props.route.params.user.userId;\n                  firebaseSet(firebaseDatabaseRef(firebaseDatabase, \"chats/\" + myUserId + \":\" + myFriendId), user);\n\n                case 10:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, null, null, null, Promise);\n        },\n        children: _jsx(Icon, {\n          name: \"paper-plane\",\n          size: 20,\n          color: colors.primary,\n          style: {\n            padding: 10\n          }\n        })\n      })]\n    })]\n  });\n};\n\nexport default Messenger;","map":{"version":3,"names":["React","useState","FlatList","TextInput","Icon","UIHeader","colors","MessengerItem","AsyncStorage","firebaseDatabase","firebaseDatabaseRef","firebaseSet","Messenger","props","route","params","user","url","name","navigation","typedText","setTypedText","showUrl","isSender","messenger","timestamp","chatHistory","setChatHistory","flexDirection","flex","goBack","alert","item","index","height","position","bottom","left","right","borderWidth","borderTopColor","justifyContent","alignItems","text","placeholder","paddingStart","color","trim","length","newMessageObject","Date","getTime","getItem","stringUser","myUserId","JSON","parse","userId","myFriendId","primary","padding"],"sources":["D:/React/react-native-project/training-app/screens/Messenger/Messeger.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport {\n    Text,\n    View,\n    Image,\n    Dimensions,\n    TouchableOpacity\n} from \"react-native\";\nimport { FlatList, TextInput } from 'react-native-gesture-handler';\nimport Icon from 'react-native-vector-icons/FontAwesome5';\nimport { SafeAreaView } from 'react-navigation';\nimport { UIHeader } from '../../components';\nimport { colors, fontSizes } from '../../constants';\nimport MessengerItem from './MessengerItem';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport {\n    auth,\n    firebaseDatabase,\n    onAuthStateChanged,\n    firebaseDatabaseRef,\n    firebaseSet\n} from '../../firebase/firebase'\n\nconst Messenger = (props: any) => {\n    const { url, name } = props.route.params.user;\n    const { navigation } = props;\n    const [typedText, setTypedText] = useState('');\n    const [chatHistory, setChatHistory] = useState([\n        {\n            url: 'https://randomuser.me/api/portraits/men/70.jpg',\n            showUrl: true,\n            isSender: true,\n            messenger: \"Hello\",\n            timestamp: 1641654238000,\n        },\n        {\n            url: 'https://randomuser.me/api/portraits/men/70.jpg',\n            showUrl: false,\n            isSender: true,\n            messenger: \"How are you ?\",\n            timestamp: 1641654298000,\n        },\n        {\n            url: 'https://randomuser.me/api/portraits/men/70.jpg',\n            showUrl: false,\n            isSender: true,\n            messenger: \"How about your work ? How about your work ? How about your work ? How about your work ? How about your work ? How about your work ?\",\n            timestamp: 1641654538000,\n        },\n        {\n            url: 'https://randomuser.me/api/portraits/men/50.jpg',\n            showUrl: true,\n            isSender: false,\n            messenger: \"Yes\",\n            timestamp: 1641654598000,\n        },\n        {\n            url: 'https://randomuser.me/api/portraits/men/50.jpg',\n            showUrl: false,\n            isSender: false,\n            messenger: \"I am fine\",\n            timestamp: 1641654598000,\n        },\n        {\n            url: 'https://randomuser.me/api/portraits/men/70.jpg',\n            showUrl: true,\n            isSender: true,\n            messenger: \"Let's go out\",\n            timestamp: 1641654778000,\n        },\n    ]);\n\n    return (\n        <View\n            style={{\n                flexDirection: 'column',\n                flex: 1\n            }}\n        >\n            <UIHeader\n                title={name}\n                lefIconName={'arrow-left'}\n                rightIconName={'ellipsis-v'}\n                onPressLeftIcon={() => {\n                    navigation.goBack();\n                }}\n                onPressRightIcon={() => {\n                    return alert('right icon');\n                }}\n            />\n            <FlatList\n                style={{\n                    flex: 1\n                }}\n                keyExtractor={(item,) => item.messenger}\n                data={chatHistory}\n                renderItem={({ item, index }) =>\n                    <MessengerItem\n                        key={`${item.timestamp}`}\n                        item={item}\n                        onPress={() => alert(\"234\")}\n                    />}\n            />\n            <View style={{\n                height: 50,\n                position: 'absolute',\n                bottom: 0,\n                left: 0,\n                right: 0,\n                borderWidth: 1,\n                borderTopColor: '#ccc',\n                flexDirection: 'row',\n                justifyContent: 'space-between',\n                alignItems: 'center'\n            }}>\n                <TextInput\n                    value={typedText}\n                    onChangeText={(text) => {\n                        setTypedText(text)\n                    }}\n                    placeholder='Enter your message here'\n                    placeholderTextColor={colors.placeholder}\n                    style={{\n                        height: 50,\n                        paddingStart: 10,\n                        color: 'black',\n                        flex: 1\n                    }}\n                />\n                <TouchableOpacity\n                    onPress={async () => {\n                        if (typedText.trim().length == 0) {\n                            return\n                        }\n\n                        let newMessageObject = {\n                            url: 'https://randomuser.me/api/portraits/men/70.jpg',\n                            showUrl: true,\n                            isSender: true,\n                            messenger: typedText,\n                            timestamp: (new Date).getTime(),\n                        }\n                        debugger\n                        let stringUser = await AsyncStorage.getItem('user');\n                        let myUserId = JSON.parse(stringUser).userId;\n                        let myFriendId = props.route.params.user.userId;\n                        //Save to firebase Database\n                        firebaseSet(firebaseDatabaseRef(\n                            firebaseDatabase,\n                            `chats/${myUserId}:${myFriendId}`\n                        ), user)\n                    }}\n                >\n                    <Icon name='paper-plane' size={20} color={colors.primary} style={{\n                        padding: 10\n                    }} />\n                </TouchableOpacity>\n            </View>\n        </View>\n    )\n}\n\nexport default Messenger"],"mappings":"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"},"metadata":{},"sourceType":"module"}